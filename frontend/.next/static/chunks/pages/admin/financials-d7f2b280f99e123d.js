(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3829],{33648:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/financials",function(){return i(49136)}])},64552:function(e,t,i){"use strict";i.d(t,{Z:function(){return b}});var n=i(85893),r=i(69554),s=i.n(r),a=i(67294),o=i(11163),l=i(41664),d=i.n(l),c=i(39483),x=i(66942),h=i(28463),p=i(24349),f=i(71408),u=i(41352),m=i(78051),y=i(77232),g=i(89508),j=i(64248);function b(e){let{children:t}=e,i=(0,o.useRouter)(),[r,l]=(0,a.useState)(!0),[b,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=()=>{window.innerWidth<1024?(k(!0),l(!1)):(k(!1),l(!0))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let B=()=>{localStorage.removeItem("admin_auth"),localStorage.removeItem("admin_auth_time"),i.replace("/admin/login")},F=[{name:"Dashboard",icon:c.Z,path:"/admin"},{name:"Financials",icon:x.Z,path:"/admin/financials"},{name:"Inventory",icon:h.Z,path:"/admin/inventory"},{name:"Orders",icon:p.Z,path:"/admin/orders"},{name:"Settings",icon:f.Z,path:"/admin/settings"}];return(0,n.jsxs)("div",{className:"jsx-2f854598db96fdd2 admin-container",children:[(0,n.jsx)(g.M,{children:b&&r&&(0,n.jsx)(j.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>l(!1),style:v.overlay})}),(0,n.jsxs)(j.E.aside,{initial:!1,animate:{width:r?280:b?0:80,x:b&&!r?-280:0},transition:{type:"spring",stiffness:300,damping:30},style:v.sidebar,children:[(0,n.jsx)("div",{style:v.logoContainer,className:"jsx-2f854598db96fdd2",children:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:"/images/kasturi-logo.png",alt:"Kasturi Admin",style:{height:160,objectFit:"contain",filter:"brightness(0) invert(1)"},className:"jsx-2f854598db96fdd2"}),b&&(0,n.jsx)("button",{onClick:()=>l(!1),style:v.mobileCloseBtn,className:"jsx-2f854598db96fdd2",children:(0,n.jsx)(u.Z,{size:20,color:"white"})})]}):(0,n.jsx)("span",{style:v.miniLogo,className:"jsx-2f854598db96fdd2",children:"K"})}),(0,n.jsx)("nav",{style:v.nav,className:"jsx-2f854598db96fdd2",children:F.map(e=>{let t="/admin"===e.path?i.pathname===e.path:i.pathname===e.path||i.pathname.startsWith("".concat(e.path,"/"));return(0,n.jsx)(d(),{href:e.path,style:{textDecoration:"none"},children:(0,n.jsxs)("div",{style:{...v.navItem,...t?v.activeNavItem:{},justifyContent:r?"flex-start":"center"},title:r?"":e.name,className:"jsx-2f854598db96fdd2",children:[(0,n.jsx)(e.icon,{size:20,color:t?"#fff":"#9CA3AF"}),r&&(0,n.jsx)(j.E.span,{initial:{opacity:0},animate:{opacity:1},style:v.navText,children:e.name})]})},e.path)})}),(0,n.jsx)("div",{style:v.footer,className:"jsx-2f854598db96fdd2",children:(0,n.jsxs)("button",{onClick:B,style:{display:"flex",alignItems:"center",gap:12,width:"100%",padding:"12px",background:"#1E293B",color:"white",border:"1px solid #334155",borderRadius:8,cursor:"pointer",fontSize:14,fontWeight:600},className:"jsx-2f854598db96fdd2",children:[(0,n.jsx)(m.Z,{size:18}),"Logout"]})})]}),(0,n.jsxs)("main",{style:{...v.main,marginLeft:b?0:r?280:80},className:"jsx-2f854598db96fdd2",children:[(0,n.jsxs)("header",{style:v.header,className:"jsx-2f854598db96fdd2",children:[(0,n.jsx)("button",{onClick:()=>l(!r),style:v.menuBtn,className:"jsx-2f854598db96fdd2",children:r&&!b?(0,n.jsx)(u.Z,{size:24}):(0,n.jsx)(y.Z,{size:24})}),(0,n.jsxs)("div",{style:v.headerRight,className:"jsx-2f854598db96fdd2",children:[b&&(0,n.jsx)("button",{onClick:B,style:{background:"#EF4444",border:"none",borderRadius:8,padding:8,color:"white",display:"flex",alignItems:"center",cursor:"pointer",marginRight:8},className:"jsx-2f854598db96fdd2",children:(0,n.jsx)(m.Z,{size:18})}),(0,n.jsxs)("div",{style:v.adminProfile,className:"jsx-2f854598db96fdd2",children:[(0,n.jsx)("img",{src:"/images/admin-photo/me.jpeg",alt:"Admin",style:{...v.avatar,objectFit:"cover",background:"transparent"},className:"jsx-2f854598db96fdd2"}),(0,n.jsx)("span",{style:v.adminName,className:"jsx-2f854598db96fdd2",children:"Admin User"})]})]})]}),(0,n.jsx)("div",{style:{padding:b?"20px 16px":"32px 40px",maxWidth:1600,margin:"0 auto",overflowX:"hidden"},className:"jsx-2f854598db96fdd2",children:(0,n.jsx)(j.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:t})})]}),(0,n.jsx)(s(),{id:"2f854598db96fdd2",children:'body{background-color:#0B0E14;margin:0;font-family:"Inter",sans-serif}.admin-container{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;min-height:100vh}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}'})]})}let v={sidebar:{height:"100dvh",background:"#0F172A",color:"#94A3B8",position:"fixed",left:0,top:0,zIndex:50,display:"flex",flexDirection:"column",overflow:"hidden",borderRight:"1px solid #1E293B",width:280,boxShadow:"4px 0 24px rgba(0,0,0,0.4)"},overlay:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(4px)",zIndex:40},logoContainer:{height:120,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid #1E293B",position:"relative",background:"#0F172A"},mobileCloseBtn:{position:"absolute",right:16,background:"#1E293B",border:"1px solid #334155",borderRadius:8,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"0.2s"},nav:{flex:1,padding:"24px 16px",display:"flex",flexDirection:"column",gap:8,overflowY:"auto"},navItem:{display:"flex",alignItems:"center",padding:"12px 16px",borderRadius:8,cursor:"pointer",position:"relative",transition:"all 0.2s ease",color:"#94A3B8",gap:12,whiteSpace:"nowrap",fontSize:14,fontWeight:500,border:"1px solid transparent"},activeNavItem:{background:"#1E293B",color:"#F8FAFC",fontWeight:"600",border:"1px solid #334155",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},navText:{fontSize:14,fontWeight:500},footer:{padding:16,borderTop:"1px solid #1E293B",background:"#0F172A"},main:{flex:1,minHeight:"100vh",transition:"margin-left 0.3s ease",width:"100%",background:"#020617",color:"#FFF"},header:{height:64,background:"#0F172A",borderBottom:"1px solid #1E293B",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 20px",position:"sticky",top:0,zIndex:40},menuBtn:{background:"#1E293B",border:"1px solid #334155",cursor:"pointer",padding:8,borderRadius:8,color:"#FFF",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},headerRight:{display:"flex",alignItems:"center",gap:16},adminProfile:{display:"flex",alignItems:"center",gap:12,padding:"6px 16px 6px 6px",background:"#1E293B",border:"1px solid #334155",borderRadius:50,cursor:"default"},avatar:{width:32,height:32,borderRadius:"50%",background:"#6366F1",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700},adminName:{fontSize:14,fontWeight:500,color:"#E2E8F0",marginRight:4}}},49136:function(e,t,i){"use strict";i.r(t);var n=i(85893),r=i(67294),s=i(64552),a=i(13025),o=i(29557),l=i(46888),d=i(14195),c=i(3023),x=i(75358),h=i(76224),p=i(41700),f=i(69408),u=i(94831),m=i(42875),y=i(36763),g=i(86434),j=i(43815);let b={header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:32},title:{fontSize:28,fontWeight:700,color:"#fff",margin:0},subtitle:{color:"#9CA3AF",fontSize:14,marginTop:4},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:24,marginBottom:32},card:{background:"#111827",borderRadius:16,padding:24,border:"1px solid #1F2937"},cardTitle:{color:"#9CA3AF",fontSize:13,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},cardValue:{color:"#fff",fontSize:32,fontWeight:700,marginTop:8,letterSpacing:"-1px"},btn:{background:"#7C3AED",color:"#fff",border:"none",padding:"10px 20px",borderRadius:8,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:8},th:{padding:"16px 24px",textAlign:"left",color:"#9CA3AF",fontSize:12,fontWeight:600,borderBottom:"1px solid #1F2937"},td:{padding:"16px 24px",color:"#E5E7EB",fontSize:14,borderBottom:"1px solid #1F2937"}},v=e=>{let{label:t,value:i,sub:r,color:s}=e;return(0,n.jsxs)("div",{style:b.card,children:[(0,n.jsx)("div",{style:b.cardTitle,children:t}),(0,n.jsx)("div",{style:{...b.cardValue,color:s||"#fff"},children:i}),(0,n.jsx)("div",{style:{...b.subtitle,color:"#6B7280"},children:r})]})};t.default=()=>{var e,t,i;let[k,B]=(0,r.useState)(null),[F,S]=(0,r.useState)(!0),C=async()=>{try{let e=localStorage.getItem("admin_token"),t=await fetch("".concat("","/api/orders/admin/financial-stats"),{headers:{Authorization:"Bearer ".concat(e)}}),i=await t.json();i.success&&B(i.data)}catch(e){console.error(e)}finally{S(!1)}};if((0,r.useEffect)(()=>{C()},[]),F)return(0,n.jsx)(s.Z,{children:(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",paddingTop:100},children:(0,n.jsx)("div",{className:"loader",children:"Loading Financials..."})})});let w=(null==k?void 0:null===(e=k.lifetime)||void 0===e?void 0:e[0])||{};null==k||null===(t=k.currentMonth)||void 0===t||t[0],null==k||null===(i=k.lastMonth)||void 0===i||i[0];let E=(null==k?void 0:k.products)||[],R=(null==k?void 0:k.monthlyTrend)||[],N=async()=>{try{let e=localStorage.getItem("admin_token"),t=await fetch("".concat("","/api/orders/admin/export-gst"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.blob(),i=window.URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download="gst-report-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(n),n.click(),n.remove()}else alert("Export Failed")}catch(e){console.error("Export Error:",e),alert("Export Error")}};return(0,n.jsxs)(s.Z,{children:[(0,n.jsxs)("div",{style:b.header,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:b.title,children:"Financial HQ"}),(0,n.jsx)("p",{style:b.subtitle,children:"Real-time Profit & Loss Analysis (Delivered Orders Only)"})]}),(0,n.jsx)("div",{style:{display:"flex",gap:12},children:(0,n.jsxs)("button",{onClick:N,style:{...b.btn,background:"#1F2937"},children:[(0,n.jsx)(a.Z,{size:18})," Export GST Report"]})})]}),(0,n.jsxs)("div",{style:b.grid,children:[(0,n.jsx)(v,{label:"Lifetime Revenue (Ex-Tax)",value:"₹".concat((w.taxableRevenue||0).toLocaleString()),sub:"₹".concat((w.totalGST||0).toLocaleString()," GST Collected"),color:"#10B981"}),(0,n.jsx)(v,{label:"Net Profit",value:"₹".concat((w.totalProfit||0).toLocaleString()),sub:"".concat((w.totalProfit/w.taxableRevenue*100||0).toFixed(1),"% Margin"),color:"#8B5CF6"}),(0,n.jsx)(v,{label:"Available Inventory Value",value:"₹--",sub:"Based on Batch Costs",color:"#F59E0B"})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:24,marginBottom:32},children:[(0,n.jsxs)("div",{style:b.card,children:[(0,n.jsxs)("div",{style:{marginBottom:20},children:[(0,n.jsx)("div",{style:b.cardTitle,children:"Monthly Financial Trend"}),(0,n.jsx)("div",{style:b.subtitle,children:"Net Profit vs Taxable Revenue"})]}),(0,n.jsx)("div",{style:{height:300},children:(0,n.jsx)(o.h,{width:"100%",height:"100%",children:(0,n.jsxs)(l.T,{data:R,margin:{top:10,right:10,left:0,bottom:0},children:[(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"colorRev",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]}),(0,n.jsxs)("linearGradient",{id:"colorProf",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,n.jsx)("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.3}),(0,n.jsx)("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:0})]})]}),(0,n.jsx)(d.q,{strokeDasharray:"3 3",stroke:"#374151",vertical:!1}),(0,n.jsx)(c.K,{dataKey:"_id.month",stroke:"#6B7280",tickFormatter:e=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e-1]}),(0,n.jsx)(x.B,{stroke:"#6B7280",tick:{fontSize:12},tickFormatter:e=>"₹".concat(e/1e3,"k")}),(0,n.jsx)(h.u,{contentStyle:{background:"#1F2937",border:"1px solid #374151",borderRadius:8},itemStyle:{color:"#fff"},formatter:e=>["₹".concat(e.toLocaleString()),""]}),(0,n.jsx)(p.D,{}),(0,n.jsx)(f.uN,{type:"monotone",dataKey:"revenue",stroke:"#10B981",fillOpacity:1,fill:"url(#colorRev)",name:"Revenue"}),(0,n.jsx)(f.uN,{type:"monotone",dataKey:"profit",stroke:"#8B5CF6",fillOpacity:1,fill:"url(#colorProf)",name:"Net Profit"})]})})})]}),(0,n.jsxs)("div",{style:b.card,children:[(0,n.jsxs)("div",{style:{marginBottom:20},children:[(0,n.jsx)("div",{style:b.cardTitle,children:"Daily Revenue (This Month)"}),(0,n.jsx)("div",{style:b.subtitle,children:"Day-wise Sales Performance"})]}),(0,n.jsx)("div",{style:{height:300},children:(0,n.jsx)(o.h,{width:"100%",height:"100%",children:(0,n.jsxs)(u.v,{data:(null==k?void 0:k.dailyTrend)||[],children:[(0,n.jsx)(d.q,{strokeDasharray:"3 3",stroke:"#374151",vertical:!1}),(0,n.jsx)(c.K,{dataKey:"_id.day",stroke:"#6B7280"}),(0,n.jsx)(x.B,{stroke:"#6B7280",tickFormatter:e=>"₹".concat(e/1e3,"k")}),(0,n.jsx)(h.u,{cursor:{fill:"rgba(255,255,255,0.05)"},contentStyle:{background:"#1F2937",border:"1px solid #374151",borderRadius:8},itemStyle:{color:"#fff"}}),(0,n.jsx)(m.$Q,{dataKey:"revenue",fill:"#3B82F6",name:"Revenue",radius:[4,4,0,0]})]})})})]})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:24,marginBottom:32},children:[(0,n.jsxs)("div",{style:b.card,children:[(0,n.jsx)("div",{style:{marginBottom:20},children:(0,n.jsx)("div",{style:b.cardTitle,children:"Revenue Source (COD vs Online)"})}),(0,n.jsx)("div",{style:{height:250,display:"flex",justifyContent:"center"},children:(0,n.jsx)(o.h,{width:"100%",height:"100%",children:(0,n.jsxs)(y.u,{children:[(0,n.jsx)(g.by,{data:(null==k?void 0:k.paymentSplit)||[],dataKey:"revenue",nameKey:"_id",cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,children:((null==k?void 0:k.paymentSplit)||[]).map((e,t)=>(0,n.jsx)(j.b,{fill:"COD"===e._id?"#F59E0B":"#8B5CF6"},"cell-".concat(t)))}),(0,n.jsx)(h.u,{contentStyle:{background:"#1F2937",border:"none",borderRadius:8}}),(0,n.jsx)(p.D,{verticalAlign:"bottom",height:36})]})})})]}),(0,n.jsxs)("div",{style:b.card,children:[(0,n.jsx)("div",{style:{marginBottom:20},children:(0,n.jsx)("div",{style:b.cardTitle,children:"Order Volume Trend"})}),(0,n.jsx)("div",{style:{height:250},children:(0,n.jsx)(o.h,{width:"100%",height:"100%",children:(0,n.jsxs)(u.v,{data:R,children:[(0,n.jsx)(d.q,{strokeDasharray:"3 3",stroke:"#374151",vertical:!1}),(0,n.jsx)(c.K,{dataKey:"_id.month",stroke:"#6B7280",tickFormatter:e=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e-1]}),(0,n.jsx)(x.B,{stroke:"#6B7280"}),(0,n.jsx)(h.u,{contentStyle:{background:"#1F2937",border:"none"}}),(0,n.jsx)(m.$Q,{dataKey:"orders",fill:"#10B981",name:"Orders Delivered",radius:[4,4,0,0],barSize:40})]})})})]})]}),(0,n.jsxs)("div",{style:b.card,children:[(0,n.jsx)("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between"},children:(0,n.jsx)("div",{style:b.cardTitle,children:"Product Profitability (Batch Accurate)"})}),(0,n.jsx)("div",{style:{overflowX:"auto"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:b.th,children:"PRODUCT / VARIANT"}),(0,n.jsx)("th",{style:b.th,children:"QTY SOLD"}),(0,n.jsx)("th",{style:b.th,children:"REVENUE (GROSS)"}),(0,n.jsx)("th",{style:b.th,children:"GST (5%)"}),(0,n.jsx)("th",{style:b.th,children:"AVG COST"}),(0,n.jsx)("th",{style:b.th,children:"EST. PROFIT"}),(0,n.jsx)("th",{style:b.th,children:"MARGIN"})]})}),(0,n.jsx)("tbody",{children:E.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{style:b.td,children:[(0,n.jsx)("div",{style:{fontWeight:500,color:"#fff"},children:e.name}),(0,n.jsx)("div",{style:{fontSize:12,color:"#6B7280"},children:e._id})]}),(0,n.jsx)("td",{style:b.td,children:e.totalQty}),(0,n.jsxs)("td",{style:b.td,children:["₹",e.totalRevenue.toLocaleString()]}),(0,n.jsx)("td",{style:b.td,children:(0,n.jsxs)("span",{style:{color:"#9CA3AF"},children:["₹",Math.round(e.totalRevenue-e.taxableRev)]})}),(0,n.jsx)("td",{style:b.td,children:(0,n.jsxs)("span",{style:{color:"#F59E0B"},children:["₹",Math.round(e.avgCost)]})}),(0,n.jsx)("td",{style:b.td,children:(0,n.jsxs)("span",{style:{color:"#10B981"},children:["+₹",Math.round(e.estProfit)]})}),(0,n.jsx)("td",{style:b.td,children:(0,n.jsxs)("span",{style:{padding:"4px 8px",borderRadius:4,background:e.estMargin>20?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)",color:e.estMargin>20?"#34D399":"#F87171",fontWeight:600,fontSize:12},children:[e.estMargin.toFixed(1),"%"]})})]},t))})]})})]})]})}}},function(e){e.O(0,[5673,2990,2888,9774,179],function(){return e(e.s=33648)}),_N_E=e.O()}]);